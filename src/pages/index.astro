---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllContent, getLatestContent, getSectionFromPage } from '../utils/data';
import { config } from '../config';

// Get all content
const allContent = await getAllContent();

// Get home page content
const homeContent = allContent.find(item => item.page === 'home');

// Get latest updates (5 most recent)
const latestUpdates = getLatestContent(5);

// Organize content by sections
const golfContent = allContent.filter(item => getSectionFromPage(item.page) === 'golf');
const portfolioContent = allContent.filter(item => getSectionFromPage(item.page) === 'portfolio');
const administrationContent = allContent.filter(item => getSectionFromPage(item.page) === 'administration');

const title = homeContent?.title || 'Vale Royal Abbey Golf Club – Seniors\' Section';
const description = 'Welcome to the Vale Royal Abbey Golf Club Seniors\' Section. Find information about competitions, matches, and club administration.';
---

<BaseLayout title={title} description={description}>
  <!-- Hero Section -->
  <section class="relative text-white overflow-hidden flex items-center justify-center" style="background-image: url('/hero-golf-course.jpg'); background-size: cover; background-position: center; background-repeat: no-repeat; min-height: 70vh;">
    <div class="absolute inset-0 bg-black bg-opacity-50"></div>
    <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
      <div class="text-center">
        <h1 class="text-4xl md:text-6xl font-bold mb-6 animate-fade-in-up">
          Vale Royal Abbey Golf Club
        </h1>
        <p class="text-xl md:text-3xl mb-8 text-green-100 animate-fade-in-up stagger-1">
          Seniors' Section
        </p>
        <!-- VRA Seniors Logo -->
        <div class="flex justify-center animate-fade-in-up stagger-2">
          <img src="/vra-seniors-logo-nr.png" alt="Vale Royal Abbey Seniors Section Logo" class="h-32 w-32 md:h-40 md:w-40 animate-float" />
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 bg-pattern-golf">
    <!-- Golf Section -->
    <section class="mb-16">
      <div class="text-center mb-8 animate-fade-in-up">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">Golf</h2>
        <p class="text-lg text-gray-600">Competitions, matches, and golfing activities</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        {golfContent.map((item, index) => (
          <div class={`bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 border border-gray-200 hover-lift animate-fade-in-up stagger-${Math.min(index + 1, 5)}`}>
            <div class="p-6">
              <h3 class="text-lg font-semibold text-gray-900 mb-3">
                <a href={`/golf/${item.slug}`} class="hover:text-green-600 transition-colors">
                  {item.title.replace('Golf – ', '')}
                </a>
              </h3>
              {item.content && (
                <p class="text-gray-600 text-sm mb-4 line-clamp-3">
                  {item.content.replace(/<[^>]*>/g, '').substring(0, 120)}...
                </p>
              )}
              {item.pdfs && item.pdfs.length > 0 && (
                <div class="flex items-center text-sm text-gray-500 mb-4">
                  <svg class="h-4 w-4 mr-1 text-red-500" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                    <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
                  </svg>
                  {item.pdfs.length} document{item.pdfs.length > 1 ? 's' : ''}
                </div>
              )}
              <a 
                href={`/golf/${item.slug}`}
                class="inline-flex items-center text-green-600 hover:text-green-700 font-medium text-sm transition-colors"
              >
                Learn more
                <svg class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
              </a>
            </div>
          </div>
        ))}
      </div>
    </section>

    <!-- Portfolio & Administration Section -->
    <section class="mb-16">
      <div class="text-center mb-8 animate-fade-in-up">
        <h2 class="text-3xl font-bold text-gray-900 mb-4">Portfolio & Administration</h2>
        <p class="text-lg text-gray-600">Club management, operations, and governance</p>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {[...portfolioContent, ...administrationContent].map((item, index) => {
          const section = getSectionFromPage(item.page);
          return (
            <div class={`bg-white rounded-lg shadow-md hover:shadow-lg transition-all duration-300 border border-gray-200 hover-lift animate-fade-in-up stagger-${Math.min(index + 1, 5)}`}>
              <div class="p-6">
                <div class="flex items-center mb-3">
                  <span class={`inline-flex items-center px-2 py-1 rounded text-xs font-medium mr-3 ${
                    section === 'portfolio' 
                      ? 'bg-blue-100 text-blue-800' 
                      : 'bg-purple-100 text-purple-800'
                  }`}>
                    {section === 'portfolio' ? 'Portfolio' : 'Administration'}
                  </span>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 mb-3">
                  <a href={`/${section}/${item.slug}`} class="hover:text-green-600 transition-colors">
                    {item.title.replace(/^(Portfolio|Administration) – /, '')}
                  </a>
                </h3>
                {item.content && (
                  <p class="text-gray-600 text-sm mb-4 line-clamp-3">
                    {item.content.replace(/<[^>]*>/g, '').substring(0, 120)}...
                  </p>
                )}
                {item.pdfs && item.pdfs.length > 0 && (
                  <div class="flex items-center text-sm text-gray-500 mb-4">
                    <svg class="h-4 w-4 mr-1 text-red-500" fill="currentColor" viewBox="0 0 20 20" aria-hidden="true">
                      <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z" clip-rule="evenodd" />
                    </svg>
                    {item.pdfs.length} document{item.pdfs.length > 1 ? 's' : ''}
                  </div>
                )}
                <a 
                  href={`/${section}/${item.slug}`}
                  class="inline-flex items-center text-green-600 hover:text-green-700 font-medium text-sm transition-colors"
                >
                  Learn more
                  <svg class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                  </svg>
                </a>
              </div>
            </div>
          );
        })}
      </div>
    </section>

    <!-- Latest Updates -->
    {latestUpdates.length > 0 && (
      <section class="animate-fade-in-up">
        <div class="bg-gray-50 rounded-lg p-8 bg-pattern-geometric">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">Latest Updates</h2>
          <div class="space-y-4">
            {latestUpdates.map((item, index) => (
              <div class={`bg-white rounded-lg p-4 shadow-sm border border-gray-200 hover-lift transition-all duration-300 animate-slide-in-left stagger-${Math.min(index + 1, 5)}`}>
                <div class="flex items-start justify-between">
                  <div class="flex-1">
                    <h3 class="font-medium text-gray-900 mb-1">
                      <a href={`/${getSectionFromPage(item.page)}/${item.slug}`} class="hover:text-green-600 transition-colors">
                        {item.title}
                      </a>
                    </h3>
                    {item.content && (
                      <p class="text-sm text-gray-600 line-clamp-2">
                        {item.content.replace(/<[^>]*>/g, '').substring(0, 150)}...
                      </p>
                    )}
                  </div>
                  {item.year && (
                    <span class="ml-4 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-800">
                      {item.year}
                    </span>
                  )}
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>
    )}
  </div>
</BaseLayout>
