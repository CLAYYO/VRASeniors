---
import { config } from '../config';
import Navigation from '../components/Navigation.astro';
import Footer from '../components/Footer.astro';
import SearchModal from '../components/SearchModal.astro';
import '../styles/global.css';

export interface Props {
  title?: string;
  description?: string;
  section?: string;
  breadcrumbs?: Array<{label: string, href: string}>;
}

const { 
  title = config.site.title, 
  description = config.site.description,
  section,
  breadcrumbs = []
} = Astro.props;

const fullTitle = title === config.site.title ? title : `${title} | ${config.site.title}`;
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="description" content={description} />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <meta name="generator" content={Astro.generator} />
  <title>{fullTitle}</title>
  
  <!-- SEO Meta Tags -->
  <meta property="og:title" content={fullTitle} />
  <meta property="og:description" content={description} />
  <meta property="og:type" content="website" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content={fullTitle} />
  <meta name="twitter:description" content={description} />
  
  <!-- Canonical URL -->
  <link rel="canonical" href={Astro.url} />
  
  <!-- JSON-LD Structured Data -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Vale Royal Abbey Golf Club - Seniors Section",
      "url": "https://vra-seniors.example.com",
      "description": "Official website for the Vale Royal Abbey Golf Club Seniors Section",
      "contactPoint": {
        "@type": "ContactPoint",
        "email": "seniors@vragc.co.uk",
        "contactType": "customer service"
      }
    }
  </script>
  
  {breadcrumbs.length > 1 && (
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": breadcrumbs.map((crumb, index) => ({
          "@type": "ListItem",
          "position": index + 1,
          "name": crumb.label,
          "item": `https://vra-seniors.example.com${crumb.href}`
        }))
      }
    </script>
  )}
</head>

<body class="min-h-screen text-gray-900 flex flex-col overflow-x-hidden" style="background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 50%, #0f766e 100%);">
  <!-- Skip to content link for accessibility -->
  <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-green-700 text-white px-4 py-2 rounded-md z-50">
    Skip to main content
  </a>
  
  <!-- Header with Navigation -->
  <header class="bg-white/95 backdrop-blur-sm shadow-lg border-b border-gray-200 sticky top-0 z-40">
    <Navigation currentSection={section} />
  </header>
  
  <!-- Main Content -->
  <main id="main-content" class="flex-1 w-full max-w-full overflow-x-hidden" role="main">
    <slot />
  </main>
  
  <!-- Footer -->
  <Footer />
  
  <!-- Search Modal -->
  <SearchModal />
  
  <!-- Scripts -->
  <script>
    // Global search functionality
    document.addEventListener('DOMContentLoaded', () => {
      const searchButton = document.getElementById('search-button');
      const searchModal = document.getElementById('search-modal');
      const searchInput = document.getElementById('search-input');
      const closeSearch = document.getElementById('close-search');
      
      if (searchButton && searchModal && searchInput && closeSearch) {
        searchButton.addEventListener('click', () => {
          searchModal.classList.remove('hidden');
          searchInput.focus();
        });
        
        closeSearch.addEventListener('click', () => {
          searchModal.classList.add('hidden');
        });
        
        // Close on escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && !searchModal.classList.contains('hidden')) {
            searchModal.classList.add('hidden');
          }
        });
        
        // Close on backdrop click
        searchModal.addEventListener('click', (e) => {
          if (e.target === searchModal) {
            searchModal.classList.add('hidden');
          }
        });
      }
    });
    
    // PDF viewer modal functionality
    (window as any).openPdfModal = function(pdfUrl: string, title: string) {
      const modal = document.getElementById('pdf-modal');
      const iframe = document.getElementById('pdf-iframe') as HTMLIFrameElement;
      const titleElement = document.getElementById('pdf-title');
      
      if (modal && iframe && titleElement) {
        titleElement.textContent = title;
        iframe.src = pdfUrl;
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }
    };
    
    (window as any).closePdfModal = function() {
      const modal = document.getElementById('pdf-modal');
      const iframe = document.getElementById('pdf-iframe') as HTMLIFrameElement;
      
      if (modal && iframe) {
        modal.classList.add('hidden');
        iframe.src = '';
        document.body.style.overflow = 'auto';
      }
    };
  </script>
  
  <!-- PDF Modal -->
  <div id="pdf-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg w-full max-w-6xl h-full max-h-[90vh] flex flex-col">
      <div class="flex items-center justify-between p-4 border-b">
        <h3 id="pdf-title" class="text-lg font-semibold text-gray-900"></h3>
        <button onclick="closePdfModal()" class="text-gray-400 hover:text-gray-600 text-2xl">
          &times;
        </button>
      </div>
      <div class="flex-1 p-4">
        <iframe id="pdf-iframe" class="w-full h-full border-0 rounded" title="PDF Viewer"></iframe>
      </div>
    </div>
  </div>
</body>
</html>

<style>
  /* Print styles */
  @media print {
    header, footer, nav, .no-print {
      display: none !important;
    }
    
    main {
      margin: 0 !important;
      padding: 0 !important;
    }
    
    .print-friendly {
      font-size: 12pt;
      line-height: 1.4;
    }
  }
</style>